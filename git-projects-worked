#!/opt/scala-2.9.2/bin/scala
exec scala "$0" "$@"
!#

import scala.sys.process._

if (args.size == 0) {
  println("Usage: git-projects-worked author [since] [until]")
  System.exit(1)
}

val author = args(0)

// extract from args array or return default if not present
def extract(idx: Int, default: String) = 
  if (args.length < idx + 1) default
  else args(idx)

val since = extract(1, "2001-01-01")
val until = extract(2, "3000-01-01")


val cmd = "git log --pretty --date=short  --name-only " +
    "--author " + author + " --since " + since + " --until " + until


println("Running " + cmd)
println

println("Projects worked on")
println("------------------")
stringToProcess(cmd)
.lines
.map { _.split("/src/") }
.filter { _.size == 2 }
.groupBy { _(0) }
.keySet
.foreach { println }



